<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>
            Json - ASP Xtreme Evolution (AXE)
        </title>
        <link rel="stylesheet" type="text/css" href="../../../../../styles/main.css" />
        <script language="JavaScript" src="../../../../../javascript/main.js" type="text/javascript">
</script>
        <script language="JavaScript" src="../../../../../javascript/searchdata.js" type="text/javascript">
</script>
    </head>
    <body class="ContentPage" onload="NDOnLoad()">
        <script language="JavaScript" type="text/javascript">
//<![CDATA[
        <!--
        if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// -->
        //]]>
        </script>
        <div id="Content">
            <div class="CClass">
                <div class="CTopic" id="MainTopic">
                    <h1 class="CTitle">
                        <a name="Json"></a>Json
                    </h1>
                    <div class="CBody">
                        <p>
                            This Class goal is to provide a simple way to parse JSON (JavaScript Object Notation) data directly from vbscript.
                        </p>
                        <h4 class="CHeading">
                            Notes
                        </h4>
                        <ul>
                            <li>JScript Class approach is inspired by CCB.JSONParser.asp <a href="http://blog.crayoncowboy.com/?p=7" class="LURL" target="_top">http://blog.crayoncowboy.com/?p=7</a> Copyright &#169; 2007 Cliff Pruitt.
                            </li>
                        </ul>
                        <h4 class="CHeading">
                            About
                        </h4>
                        <ul>
                            <li>Written by Fabio Zendhi Nagao <a href="http://zend.lojcomm.com.br/" class="LURL" target="_top">http://zend.lojcomm.com.br/</a> @ January 2008
                            </li>
                        </ul>
                        <div class="Summary">
                            <div class="STitle">
                                Summary
                            </div>
                            <div class="SBorder">
                                <table border="0" cellspacing="0" cellpadding="0" class="STable">
                                    <tr class="SMain">
                                        <td class="SEntry">
                                            <a href="#Json">Json</a>
                                        </td>
                                        <td class="SDescription">
                                            This Class goal is to provide a simple way to parse JSON (JavaScript Object Notation) data directly from vbscript.
                                        </td>
                                    </tr>
                                    <tr class="SGroup SIndent1">
                                        <td class="SEntry">
                                            <a href="#Json.Properties">Properties</a>
                                        </td>
                                        <td class="SDescription"></td>
                                    </tr>
                                    <tr class="SProperty SIndent2 SMarked">
                                        <td class="SEntry">
                                            <a href="#Json.classType">classType</a>
                                        </td>
                                        <td class="SDescription">
                                            Class type.
                                        </td>
                                    </tr>
                                    <tr class="SProperty SIndent2">
                                        <td class="SEntry">
                                            <a href="#Json.classVersion">classVersion</a>
                                        </td>
                                        <td class="SDescription">
                                            Class version.
                                        </td>
                                    </tr>
                                    <tr class="SGroup SIndent1">
                                        <td class="SEntry">
                                            <a href="#Json.Functions">Functions</a>
                                        </td>
                                        <td class="SDescription"></td>
                                    </tr>
                                    <tr class="SFunction SIndent2 SMarked">
                                        <td class="SEntry">
                                            <a href="#Json.loadJson" id="link1" onmouseover="ShowTip(event, 'tt1', 'link1')" onmouseout="HideTip('tt1')">loadJson</a>
                                        </td>
                                        <td class="SDescription">
                                            Since ASP Classes strangely doesn&#8217;t accept parameters at it&#8217;s initializa- tion.
                                        </td>
                                    </tr>
                                    <tr class="SFunction SIndent2">
                                        <td class="SEntry">
                                            <a href="#Json.getElement" id="link2" onmouseover="ShowTip(event, 'tt2', 'link2')" onmouseout="HideTip('tt2')">getElement</a>
                                        </td>
                                        <td class="SDescription">
                                            This function takes a dot separated path and look for the element value in the JSON.
                                        </td>
                                    </tr>
                                    <tr class="SFunction SIndent2 SMarked">
                                        <td class="SEntry">
                                            <a href="#Json.setElement" id="link3" onmouseover="ShowTip(event, 'tt3', 'link3')" onmouseout="HideTip('tt3')">setElement</a>
                                        </td>
                                        <td class="SDescription">
                                            This subroutine augments the JSON by adding elements to it.
                                        </td>
                                    </tr>
                                    <tr class="SFunction SIndent2">
                                        <td class="SEntry">
                                            <a href="#Json.removeElement" id="link4" onmouseover="ShowTip(event, 'tt4', 'link4')" onmouseout="HideTip('tt4')">removeElement</a>
                                        </td>
                                        <td class="SDescription">
                                            This subroutine removes a node from the object.
                                        </td>
                                    </tr>
                                    <tr class="SFunction SIndent2 SMarked">
                                        <td class="SEntry">
                                            <a href="#Json.getChildNodes" id="link5" onmouseover="ShowTip(event, 'tt5', 'link5')" onmouseout="HideTip('tt5')">getChildNodes</a>
                                        </td>
                                        <td class="SDescription">
                                            Look for all element child keys and enumerate them.
                                        </td>
                                    </tr>
                                    <tr class="SFunction SIndent2">
                                        <td class="SEntry">
                                            <a href="#Json.serialize" id="link6" onmouseover="ShowTip(event, 'tt6', 'link6')" onmouseout="HideTip('tt6')">serialize</a>
                                        </td>
                                        <td class="SDescription">
                                            Converts the object into a JSON string.
                                        </td>
                                    </tr>
                                    <tr class="SFunction SIndent2 SMarked">
                                        <td class="SEntry">
                                            <a href="#Json.new_JsonEngine" id="link7" onmouseover="ShowTip(event, 'tt7', 'link7')" onmouseout="HideTip('tt7')">new_JsonEngine</a>
                                        </td>
                                        <td class="SDescription">
                                            Private function used to create a new instance of the JsonEngine Class.
                                        </td>
                                    </tr>
                                    <tr class="SClass">
                                        <td class="SEntry">
                                            <a href="#JsonEngine">JsonEngine</a>
                                        </td>
                                        <td class="SDescription">
                                            Since VBScript doesn&#8217;t provide a native method to handle JSON, this class ma- kes the magic of wrapping JScript JSON to VBScript.
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="CGroup">
                <div class="CTopic">
                    <h3 class="CTitle">
                        <a name="Json.Properties"></a>Properties
                    </h3>
                </div>
            </div>
            <div class="CProperty">
                <div class="CTopic">
                    <h3 class="CTitle">
                        <a name="Json.classType"></a>classType
                    </h3>
                    <div class="CBody">
                        <p>
                            Class type.
                        </p>
                        <h4 class="CHeading">
                            Contains
                        </h4>
                        <table border="0" cellspacing="0" cellpadding="0" class="CDescriptionList">
                            <tr>
                                <td class="CDLEntry">
                                    (string)
                                </td>
                                <td class="CDLDescription">
                                    type
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="CProperty">
                <div class="CTopic">
                    <h3 class="CTitle">
                        <a name="Json.classVersion"></a>classVersion
                    </h3>
                    <div class="CBody">
                        <p>
                            Class version.
                        </p>
                        <h4 class="CHeading">
                            Contains
                        </h4>
                        <table border="0" cellspacing="0" cellpadding="0" class="CDescriptionList">
                            <tr>
                                <td class="CDLEntry">
                                    (float)
                                </td>
                                <td class="CDLDescription">
                                    version
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="CGroup">
                <div class="CTopic">
                    <h3 class="CTitle">
                        <a name="Json.Functions"></a>Functions
                    </h3>
                </div>
            </div>
            <div class="CFunction">
                <div class="CTopic">
                    <h3 class="CTitle">
                        <a name="Json.loadJson"></a>loadJson
                    </h3>
                    <div class="CBody">
                        <blockquote>
                            <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                                <tr>
                                    <td>
                                        <table border="0" cellspacing="0" cellpadding="0">
                                            <tr>
                                                <td class="PBeforeParameters" nowrap="nowrap">
                                                    public sub loadJson(
                                                </td>
                                                <td class="PParameter" nowrap="nowrap">
                                                    sJson
                                                </td>
                                                <td class="PAfterParameters" nowrap="nowrap">
                                                    )
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </blockquote>
                        <p>
                            Since ASP Classes strangely doesn&#8217;t accept parameters at it&#8217;s initializa- tion.&nbsp; Use this subroutine to load the object.
                        </p>
                        <h4 class="CHeading">
                            Parameters
                        </h4>
                        <table border="0" cellspacing="0" cellpadding="0" class="CDescriptionList">
                            <tr>
                                <td class="CDLEntry">
                                    (string)
                                </td>
                                <td class="CDLDescription">
                                    The Json string representation
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="CFunction">
                <div class="CTopic">
                    <h3 class="CTitle">
                        <a name="Json.getElement"></a>getElement
                    </h3>
                    <div class="CBody">
                        <blockquote>
                            <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                                <tr>
                                    <td>
                                        <table border="0" cellspacing="0" cellpadding="0">
                                            <tr>
                                                <td class="PBeforeParameters" nowrap="nowrap">
                                                    public function getElement(
                                                </td>
                                                <td class="PParameter" nowrap="nowrap">
                                                    sPath
                                                </td>
                                                <td class="PAfterParameters" nowrap="nowrap">
                                                    )
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </blockquote>
                        <p>
                            This function takes a dot separated path and look for the element value in the JSON.
                        </p>
                        <h4 class="CHeading">
                            Parameters
                        </h4>
                        <table border="0" cellspacing="0" cellpadding="0" class="CDescriptionList">
                            <tr>
                                <td class="CDLEntry">
                                    (string)
                                </td>
                                <td class="CDLDescription">
                                    Relative path from root
                                </td>
                            </tr>
                        </table>
                        <h4 class="CHeading">
                            Returns
                        </h4>
                        <table border="0" cellspacing="0" cellpadding="0" class="CDescriptionList">
                            <tr>
                                <td class="CDLEntry">
                                    (string)
                                </td>
                                <td class="CDLDescription">
                                    The element value
                                </td>
                            </tr>
                        </table>
                        <h4 class="CHeading">
                            Example
                        </h4>
                        <pre class="asp" style="font-family:monospace;">
<span class="kw1">dim</span> sJson, oJson
 
sJson <span class="sy0">=</span> join<span class="br0">(</span><span class="kw3">array</span><span class="br0">(</span> _
<span class="st0">"{"</span>, _
<span class="st0">"    'hello' : 'Hello World !',"</span>, _
<span class="st0">"    'howdy' : 'How do you do ?',"</span>, _
<span class="st0">"    'fields' : {"</span>, _
<span class="st0">"       'one': 1,"</span>, _
<span class="st0">"       'two': 2,"</span>, _
<span class="st0">"       'three': 3,"</span>, _
<span class="st0">"       'four': [ 'one', 'two,three', 'four' ],"</span>, _
<span class="st0">"       'five': { 'one' : 'apple', 'two' : 'orange', 'three' : 'banana' }"</span>, _
<span class="st0">"    }"</span>, _
<span class="st0">"};"</span> _
<span class="br0">)</span>, vbNewLine<span class="br0">)</span>
 
<span class="kw1">set</span> oJson <span class="sy0">=</span> <span class="kw2">new</span> Json
oJson.<span class="me1">loadJson</span><span class="br0">(</span>sJson<span class="br0">)</span>
<span class="kw1">Response</span>.<span class="kw3">write</span><span class="br0">(</span>oJson.<span class="me1">getElement</span><span class="br0">(</span><span class="st0">"hello"</span><span class="br0">)</span> <span class="sy0">&amp;</span> <span class="st0">"&lt;br /&gt;"</span> <span class="sy0">&amp;</span> vbNewLine<span class="br0">)</span>
<span class="kw1">Response</span>.<span class="kw3">write</span><span class="br0">(</span>oJson.<span class="me1">getElement</span><span class="br0">(</span><span class="st0">"howdy"</span><span class="br0">)</span> <span class="sy0">&amp;</span> <span class="st0">"&lt;br /&gt;"</span> <span class="sy0">&amp;</span> vbNewLine<span class="br0">)</span>
<span class="kw1">set</span> oJson <span class="sy0">=</span> <span class="kw2">nothing</span>
</pre>
                    </div>
                </div>
            </div>
            <div class="CFunction">
                <div class="CTopic">
                    <h3 class="CTitle">
                        <a name="Json.setElement"></a>setElement
                    </h3>
                    <div class="CBody">
                        <blockquote>
                            <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                                <tr>
                                    <td>
                                        <table border="0" cellspacing="0" cellpadding="0">
                                            <tr>
                                                <td class="PBeforeParameters" nowrap="nowrap">
                                                    public sub setElement(
                                                </td>
                                                <td class="PParameter" nowrap="nowrap">
                                                    sPath,
                                                </td>
                                            </tr>
                                            <tr>
                                                <td></td>
                                                <td class="PParameter" nowrap="nowrap">
                                                    value
                                                </td>
                                                <td class="PAfterParameters" nowrap="nowrap">
                                                    )
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </blockquote>
                        <p>
                            This subroutine augments the JSON by adding elements to it.
                        </p>
                        <h4 class="CHeading">
                            Notes
                        </h4>
                        <ul>
                            <li>You can pass valid JSON Objects and Arrays as strings ( { ...&nbsp; } and [ ...&nbsp; ] ) respectively and this function will encode it to javascript.
                            </li>
                            <li>The above note said valid JSON.&nbsp; Which means Objects and Arrays should escape &#8220; properly (\&#8221;) since it&#8217;s used as the JSON string delimiter.
                            </li>
                        </ul>
                        <h4 class="CHeading">
                            Example
                        </h4>
                        <pre class="asp" style="font-family:monospace;">
<span class="kw1">set</span> oJson <span class="sy0">=</span> <span class="kw2">new</span> Json
oJson.<span class="me1">loadJson</span><span class="br0">(</span><span class="st0">"{}"</span><span class="br0">)</span>
 
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"obj"</span>, <span class="st0">"{'key':'value'}"</span><span class="br0">)</span>
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"arr"</span>, <span class="st0">"[1,2,3,4]"</span><span class="br0">)</span>
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"str"</span>, <span class="st0">"string"</span><span class="br0">)</span>
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"int"</span>, 1982<span class="br0">)</span>
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"bool"</span>, <span class="kw2">true</span><span class="br0">)</span>
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"obj.augment"</span>, <span class="st0">"I'm augmenting the first setElement element XD"</span><span class="br0">)</span>
<span class="kw1">Response</span>.<span class="kw3">write</span><span class="br0">(</span>oJson.<span class="me1">serialize</span><span class="br0">(</span><span class="st0">""</span><span class="br0">)</span> <span class="sy0">&amp;</span> <span class="st0">"&lt;br /&gt;"</span> <span class="sy0">&amp;</span> vbNewLine<span class="br0">)</span>
 
<span class="kw1">set</span> oJson <span class="sy0">=</span> <span class="kw2">nothing</span>
</pre>
                    </div>
                </div>
            </div>
            <div class="CFunction">
                <div class="CTopic">
                    <h3 class="CTitle">
                        <a name="Json.removeElement"></a>removeElement
                    </h3>
                    <div class="CBody">
                        <blockquote>
                            <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                                <tr>
                                    <td>
                                        <table border="0" cellspacing="0" cellpadding="0">
                                            <tr>
                                                <td class="PBeforeParameters" nowrap="nowrap">
                                                    public sub removeElement(
                                                </td>
                                                <td class="PParameter" nowrap="nowrap">
                                                    sPath
                                                </td>
                                                <td class="PAfterParameters" nowrap="nowrap">
                                                    )
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </blockquote>
                        <p>
                            This subroutine removes a node from the object.
                        </p>
                        <h4 class="CHeading">
                            Notes
                        </h4>
                        <ul>
                            <li>Caution!&nbsp; It&#8217;s recursive, removing a container ( Object or Array ) result in erasing it and all it&#8217;s content.
                            </li>
                        </ul>
                        <h4 class="CHeading">
                            Example
                        </h4>
                        <pre class="asp" style="font-family:monospace;">
<span class="kw1">set</span> oJson <span class="sy0">=</span> <span class="kw2">new</span> Json
oJson.<span class="me1">loadJson</span><span class="br0">(</span><span class="st0">"{}"</span><span class="br0">)</span>
 
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"obj"</span>, <span class="st0">"{'key':'value'}"</span><span class="br0">)</span>
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"arr"</span>, <span class="st0">"[1,2,3,4]"</span><span class="br0">)</span>
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"str"</span>, <span class="st0">"string"</span><span class="br0">)</span>
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"int"</span>, 1982<span class="br0">)</span>
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"bool"</span>, <span class="kw2">true</span><span class="br0">)</span>
<span class="kw1">call</span> oJson.<span class="me1">setElement</span><span class="br0">(</span><span class="st0">"obj.augment"</span>, <span class="st0">"I'm augmenting the first setElement element XD"</span><span class="br0">)</span>
<span class="kw1">Response</span>.<span class="kw3">write</span><span class="br0">(</span>oJson.<span class="me1">serialize</span><span class="br0">(</span><span class="st0">""</span><span class="br0">)</span> <span class="sy0">&amp;</span> <span class="st0">"&lt;br /&gt;"</span> <span class="sy0">&amp;</span> vbNewLine<span class="br0">)</span>
 
<span class="kw1">call</span> oJson.<span class="me1">removeElement</span><span class="br0">(</span><span class="st0">"obj.augment"</span><span class="br0">)</span>
<span class="kw1">Response</span>.<span class="kw3">write</span><span class="br0">(</span>oJson.<span class="me1">serialize</span><span class="br0">(</span><span class="st0">""</span><span class="br0">)</span> <span class="sy0">&amp;</span> <span class="st0">"&lt;br /&gt;"</span> <span class="sy0">&amp;</span> vbNewLine<span class="br0">)</span>
 
<span class="kw1">set</span> oJson <span class="sy0">=</span> <span class="kw2">nothing</span>
</pre>
                    </div>
                </div>
            </div>
            <div class="CFunction">
                <div class="CTopic">
                    <h3 class="CTitle">
                        <a name="Json.getChildNodes"></a>getChildNodes
                    </h3>
                    <div class="CBody">
                        <blockquote>
                            <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                                <tr>
                                    <td>
                                        <table border="0" cellspacing="0" cellpadding="0">
                                            <tr>
                                                <td class="PBeforeParameters" nowrap="nowrap">
                                                    public function getChildNodes(
                                                </td>
                                                <td class="PParameter" nowrap="nowrap">
                                                    sPath
                                                </td>
                                                <td class="PAfterParameters" nowrap="nowrap">
                                                    )
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </blockquote>
                        <p>
                            Look for all element child keys and enumerate them.
                        </p>
                        <h4 class="CHeading">
                            Parameters
                        </h4>
                        <table border="0" cellspacing="0" cellpadding="0" class="CDescriptionList">
                            <tr>
                                <td class="CDLEntry">
                                    (string)
                                </td>
                                <td class="CDLDescription">
                                    Path to the parent element relative to root.
                                </td>
                            </tr>
                        </table>
                        <h4 class="CHeading">
                            Returns
                        </h4>
                        <table border="0" cellspacing="0" cellpadding="0" class="CDescriptionList">
                            <tr>
                                <td class="CDLEntry">
                                    (string[])
                                </td>
                                <td class="CDLDescription">
                                    With the child keys
                                </td>
                            </tr>
                        </table>
                        <h4 class="CHeading">
                            Example
                        </h4>
                        <pre class="asp" style="font-family:monospace;">
<span class="kw1">dim</span> sJson, oJson, key
 
sJson <span class="sy0">=</span> join<span class="br0">(</span><span class="kw3">array</span><span class="br0">(</span> _
<span class="st0">"{"</span>, _
<span class="st0">"    'hello' : 'Hello World !',"</span>, _
<span class="st0">"    'howdy' : 'How do you do ?',"</span>, _
<span class="st0">"    'fields' : {"</span>, _
<span class="st0">"       'one': 1,"</span>, _
<span class="st0">"       'two': 2,"</span>, _
<span class="st0">"       'three': 3,"</span>, _
<span class="st0">"       'four': [ 'one', 'two,three', 'four' ],"</span>, _
<span class="st0">"       'five': { 'one' : 'apple', 'two' : 'orange', 'three' : 'banana' }"</span>, _
<span class="st0">"    }"</span>, _
<span class="st0">"};"</span> _
<span class="br0">)</span>, vbNewLine<span class="br0">)</span>
 
<span class="kw1">set</span> oJson <span class="sy0">=</span> <span class="kw2">new</span> Json
oJson.<span class="me1">loadJson</span><span class="br0">(</span>sJson<span class="br0">)</span>
<span class="kw1">for</span> <span class="kw1">each</span> key <span class="kw1">in</span> oJson.<span class="me1">getChildNodes</span><span class="br0">(</span><span class="st0">""</span><span class="br0">)</span>
    <span class="kw1">Response</span>.<span class="kw3">write</span><span class="br0">(</span>key <span class="sy0">&amp;</span> <span class="st0">" : "</span> <span class="sy0">&amp;</span> oJson.<span class="me1">getElement</span><span class="br0">(</span>key<span class="br0">)</span> <span class="sy0">&amp;</span> <span class="st0">"&lt;br /&gt;"</span> <span class="sy0">&amp;</span> vbNewLine<span class="br0">)</span>
<span class="kw1">next</span>
<span class="kw1">set</span> oJson <span class="sy0">=</span> <span class="kw2">nothing</span>
</pre>
                    </div>
                </div>
            </div>
            <div class="CFunction">
                <div class="CTopic">
                    <h3 class="CTitle">
                        <a name="Json.serialize"></a>serialize
                    </h3>
                    <div class="CBody">
                        <blockquote>
                            <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                                <tr>
                                    <td>
                                        <table border="0" cellspacing="0" cellpadding="0">
                                            <tr>
                                                <td class="PBeforeParameters" nowrap="nowrap">
                                                    public function serialize(
                                                </td>
                                                <td class="PParameter" nowrap="nowrap">
                                                    path
                                                </td>
                                                <td class="PAfterParameters" nowrap="nowrap">
                                                    )
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </blockquote>
                        <p>
                            Converts the object into a JSON string.
                        </p>
                        <h4 class="CHeading">
                            Parameters
                        </h4>
                        <table border="0" cellspacing="0" cellpadding="0" class="CDescriptionList">
                            <tr>
                                <td class="CDLEntry">
                                    (string)
                                </td>
                                <td class="CDLDescription">
                                    starting path.&nbsp; &#8220;&#8221; means the entire object.
                                </td>
                            </tr>
                        </table>
                        <h4 class="CHeading">
                            Returns
                        </h4>
                        <table border="0" cellspacing="0" cellpadding="0" class="CDescriptionList">
                            <tr>
                                <td class="CDLEntry">
                                    (string)
                                </td>
                                <td class="CDLDescription">
                                    a JSON string
                                </td>
                            </tr>
                        </table>
                        <h4 class="CHeading">
                            Example
                        </h4>
                        <pre class="asp" style="font-family:monospace;">
<span class="kw1">dim</span> sJson, oJson, key
 
sJson <span class="sy0">=</span> join<span class="br0">(</span><span class="kw3">array</span><span class="br0">(</span> _
<span class="st0">"{"</span>, _
<span class="st0">"    'hello' : 'Hello World !',"</span>, _
<span class="st0">"    'howdy' : 'How do you do ?',"</span>, _
<span class="st0">"    'fields' : {"</span>, _
<span class="st0">"       'one': 1,"</span>, _
<span class="st0">"       'two': 2,"</span>, _
<span class="st0">"       'three': 3,"</span>, _
<span class="st0">"       'four': [ 'one', 'two,three', 'four' ],"</span>, _
<span class="st0">"       'five': { 'one' : 'apple', 'two' : 'orange', 'three' : 'banana' }"</span>, _
<span class="st0">"    },"</span>, _
<span class="st0">"    'boolean' : true"</span>, _
<span class="st0">"};"</span> _
<span class="br0">)</span>, vbNewLine<span class="br0">)</span>
 
<span class="kw1">set</span> oJson <span class="sy0">=</span> <span class="kw2">new</span> Json
oJson.<span class="me1">loadJson</span><span class="br0">(</span>sJson<span class="br0">)</span>
<span class="kw1">Response</span>.<span class="kw3">write</span> oJson.<span class="me1">serialize</span><span class="br0">(</span><span class="st0">""</span><span class="br0">)</span>
<span class="kw1">set</span> oJson <span class="sy0">=</span> <span class="kw2">nothing</span>
</pre>
                    </div>
                </div>
            </div>
            <div class="CFunction">
                <div class="CTopic">
                    <h3 class="CTitle">
                        <a name="Json.new_JsonEngine"></a>new_JsonEngine
                    </h3>
                    <div class="CBody">
                        <blockquote>
                            <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                                <tr>
                                    <td>
                                        <table border="0" cellspacing="0" cellpadding="0">
                                            <tr>
                                                <td class="PBeforeParameters" nowrap="nowrap">
                                                    function new_JsonEngine(
                                                </td>
                                                <td class="PParameter" nowrap="nowrap">
                                                    sJson
                                                </td>
                                                <td class="PAfterParameters" nowrap="nowrap">
                                                    )
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </blockquote>
                        <p>
                            Private function used to create a new instance of the JsonEngine Class.
                        </p>
                        <h4 class="CHeading">
                            Parameters
                        </h4>
                        <table border="0" cellspacing="0" cellpadding="0" class="CDescriptionList">
                            <tr>
                                <td class="CDLEntry">
                                    (string)
                                </td>
                                <td class="CDLDescription">
                                    The Json string representation
                                </td>
                            </tr>
                        </table>
                        <h4 class="CHeading">
                            Returns
                        </h4>
                        <table border="0" cellspacing="0" cellpadding="0" class="CDescriptionList">
                            <tr>
                                <td class="CDLEntry">
                                    (object)
                                </td>
                                <td class="CDLDescription">
                                    The Json root.
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="CClass">
                <div class="CTopic">
                    <h2 class="CTitle">
                        <a name="JsonEngine"></a>JsonEngine
                    </h2>
                    <div class="CBody">
                        <p>
                            Since VBScript doesn&#8217;t provide a native method to handle JSON, this class ma- kes the magic of wrapping JScript JSON to VBScript.&nbsp; Note that this class me- thods are the same of the Json class above and just make what they was suppo- sed to do.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div id="Footer">
            Documentation by <a href="http://zend.lojcomm.com.br/">Fabio Zendhi Nagao</a>&nbsp; &#183;&nbsp; Generated by <a href="http://qbnz.com/highlighter/">GeSHi</a>, <a href="http://tidy.sourceforge.net/">Tidy</a> and <a href="http://www.naturaldocs.org">Natural Docs</a>
        </div>
        <div id="Menu">
            <div class="MTitle">
                ASP Xtreme Evolution (AXE)
            </div>
            <div class="MEntry">
                <div class="MGroup">
                    <a href="javascript:ToggleMenu('MGroupContent1')">Framework</a>
                    <div class="MGroupContent" id="MGroupContent1">
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../base-asp.html">ASP Extensions</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../base-math-asp.html">ASP Math Extensions</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../customevent-class-asp.html">CustomEvent</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../kernel-class-asp.html">Kernel</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../unittest-class-asp.html">UnitTest</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="MEntry">
                <div class="MGroup">
                    <a href="javascript:ToggleMenu('MGroupContent2')">Parsers</a>
                    <div class="MGroupContent" id="MGroupContent2">
                        <div class="MEntry">
                            <div class="MFile" id="MSelected">
                                Json
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="markdown-class-asp.html">Markdown</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="MEntry">
                <div class="MGroup">
                    <a href="javascript:ToggleMenu('MGroupContent3')">Services</a>
                    <div class="MGroupContent" id="MGroupContent3">
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Services/akismet-class-asp.html">Akismet</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Services/recaptcha-class-asp.html">ReCaptcha</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="MEntry">
                <div class="MGroup">
                    <a href="javascript:ToggleMenu('MGroupContent4')">Security</a>
                    <div class="MGroupContent" id="MGroupContent4">
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Security/md5-class-asp.html">MD5</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Security/rijndael-class-asp.html">Rijndael</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Security/sha256-class-asp.html">SHA256</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="MEntry">
                <div class="MGroup">
                    <a href="javascript:ToggleMenu('MGroupContent5')">Utilities</a>
                    <div class="MGroupContent" id="MGroupContent5">
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Utilities/base64-class-asp.html">Base64</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Utilities/color-class-asp.html">Color</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Utilities/image-class-asp.html">Image</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Utilities/paginator-class-asp.html">Paginator</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Utilities/stringbuilder-class-asp.html">StringBuilder</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Utilities/template-class-asp.html">Template</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Utilities/upload-class-asp.html">Upload</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../Utilities/zip-class-asp.html">Zip</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="MEntry">
                <div class="MGroup">
                    <a href="javascript:ToggleMenu('MGroupContent6')">Files</a>
                    <div class="MGroupContent" id="MGroupContent6">
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../../../default-asp.html">default.asp</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../application-configure-asp.html">application.<wbr />configure.asp</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../sessions-finalize-asp.html">sessions.<wbr />finalize.asp</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../sessions-initialize-asp.html">sessions.<wbr />initialize.asp</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../shuttle-unload-finalize-asp.html">shuttle.<wbr />unload.<wbr />finalize.asp</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../shuttle-unload-initialize-asp.html">shuttle.<wbr />unload.<wbr />initialize.asp</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../singletons-finalize-asp.html">singletons.<wbr />finalize.asp</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../singletons-initialize-asp.html">singletons.<wbr />initialize.asp</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../../views/error-asp.html">error.asp</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../../views/inspect-asp.html">inspect.asp</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MFile">
                                <a href="../../../models/_templateModel-asp.html">app\<wbr />models\<wbr />_templateModel.asp</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="MEntry">
                <div class="MGroup">
                    <a href="javascript:ToggleMenu('MGroupContent7')">Index</a>
                    <div class="MGroupContent" id="MGroupContent7">
                        <div class="MEntry">
                            <div class="MIndex">
                                <a href="../../../../../index/General.html">Everything</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MIndex">
                                <a href="../../../../../index/Classes.html">Classes</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MIndex">
                                <a href="../../../../../index/Files.html">Files</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MIndex">
                                <a href="../../../../../index/Functions.html">Functions</a>
                            </div>
                        </div>
                        <div class="MEntry">
                            <div class="MIndex">
                                <a href="../../../../../index/Properties.html">Properties</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div><script type="text/javascript">
//<![CDATA[
            <!--
            var searchPanel = new SearchPanel("searchPanel", "HTML", "../../../../../search");
            -->
            //]]>
            </script>
            <div id="MSearchPanel" class="MSearchPanelInactive">
                <input type="text" id="MSearchField" value="Search" onfocus="searchPanel.OnSearchFieldFocus(true)" onblur="searchPanel.OnSearchFieldFocus(false)" onkeyup="searchPanel.OnSearchFieldChange()" /><select id="MSearchType" onfocus="searchPanel.OnSearchTypeFocus(true)" onblur="searchPanel.OnSearchTypeFocus(false)" onchange="searchPanel.OnSearchTypeChange()">
                    <option id="MSearchEverything" selected="selected" value="General">
                        Everything
                    </option>
                    <option value="Classes">
                        Classes
                    </option>
                    <option value="Files">
                        Files
                    </option>
                    <option value="Functions">
                        Functions
                    </option>
                    <option value="Properties">
                        Properties
                    </option>
                </select>
            </div><script language="JavaScript" type="text/javascript">
//<![CDATA[
            <!--
            HideAllBut([2, 3, 1, 4], 8);// -->
            //]]>
            </script>
        </div>
        <div class="CToolTip" id="tt1">
            <div class="CFunction">
                <blockquote>
                    <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                        <tr>
                            <td>
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td class="PBeforeParameters" nowrap="nowrap">
                                            public sub loadJson(
                                        </td>
                                        <td class="PParameter" nowrap="nowrap">
                                            sJson
                                        </td>
                                        <td class="PAfterParameters" nowrap="nowrap">
                                            )
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </blockquote>Since ASP Classes strangely doesn&#8217;t accept parameters at it&#8217;s initializa- tion.
            </div>
        </div>
        <div class="CToolTip" id="tt2">
            <div class="CFunction">
                <blockquote>
                    <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                        <tr>
                            <td>
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td class="PBeforeParameters" nowrap="nowrap">
                                            public function getElement(
                                        </td>
                                        <td class="PParameter" nowrap="nowrap">
                                            sPath
                                        </td>
                                        <td class="PAfterParameters" nowrap="nowrap">
                                            )
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </blockquote>This function takes a dot separated path and look for the element value in the JSON.
            </div>
        </div>
        <div class="CToolTip" id="tt3">
            <div class="CFunction">
                <blockquote>
                    <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                        <tr>
                            <td>
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td class="PBeforeParameters" nowrap="nowrap">
                                            public sub setElement(
                                        </td>
                                        <td class="PParameter" nowrap="nowrap">
                                            sPath,
                                        </td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td class="PParameter" nowrap="nowrap">
                                            value
                                        </td>
                                        <td class="PAfterParameters" nowrap="nowrap">
                                            )
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </blockquote>This subroutine augments the JSON by adding elements to it.
            </div>
        </div>
        <div class="CToolTip" id="tt4">
            <div class="CFunction">
                <blockquote>
                    <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                        <tr>
                            <td>
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td class="PBeforeParameters" nowrap="nowrap">
                                            public sub removeElement(
                                        </td>
                                        <td class="PParameter" nowrap="nowrap">
                                            sPath
                                        </td>
                                        <td class="PAfterParameters" nowrap="nowrap">
                                            )
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </blockquote>This subroutine removes a node from the object.
            </div>
        </div>
        <div class="CToolTip" id="tt5">
            <div class="CFunction">
                <blockquote>
                    <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                        <tr>
                            <td>
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td class="PBeforeParameters" nowrap="nowrap">
                                            public function getChildNodes(
                                        </td>
                                        <td class="PParameter" nowrap="nowrap">
                                            sPath
                                        </td>
                                        <td class="PAfterParameters" nowrap="nowrap">
                                            )
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </blockquote>Look for all element child keys and enumerate them.
            </div>
        </div>
        <div class="CToolTip" id="tt6">
            <div class="CFunction">
                <blockquote>
                    <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                        <tr>
                            <td>
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td class="PBeforeParameters" nowrap="nowrap">
                                            public function serialize(
                                        </td>
                                        <td class="PParameter" nowrap="nowrap">
                                            path
                                        </td>
                                        <td class="PAfterParameters" nowrap="nowrap">
                                            )
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </blockquote>Converts the object into a JSON string.
            </div>
        </div>
        <div class="CToolTip" id="tt7">
            <div class="CFunction">
                <blockquote>
                    <table border="0" cellspacing="0" cellpadding="0" class="Prototype">
                        <tr>
                            <td>
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <tr>
                                        <td class="PBeforeParameters" nowrap="nowrap">
                                            function new_JsonEngine(
                                        </td>
                                        <td class="PParameter" nowrap="nowrap">
                                            sJson
                                        </td>
                                        <td class="PAfterParameters" nowrap="nowrap">
                                            )
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </blockquote>Private function used to create a new instance of the JsonEngine Class.
            </div>
        </div>
        <div id="MSearchResultsWindow">
            <iframe src="" frameborder="0" name="MSearchResults" id="MSearchResults"></iframe><a href="javascript:searchPanel.CloseResultsWindow()" id="MSearchResultsWindowClose">Close</a>
        </div><script language="JavaScript" type="text/javascript">
//<![CDATA[
        <!--
        if (browserType) {if (browserVer) {document.write("<\/div>"); }document.write("<\/div>");}// -->
        //]]>
        </script>
    </body>
</html>